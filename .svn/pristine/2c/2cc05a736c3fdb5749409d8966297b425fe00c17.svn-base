webpackJsonp([4],{"02PY":function(t,a){},"7jK+":function(t,a){},"8Bkq":function(t,a){},CaBG:function(t,a,e){"use strict";var i,n,r,s,o,c,l=e("GxD7"),d=e.n(l),u=e("exGp"),h=e.n(u),p=e("M4fF"),f=e.n(p),m=e("mw3O"),v=e.n(m),_=e("cKc3"),g=e("bzuE"),b=this,y=(i=h()(d.a.mark(function t(a){var e,i,n=a.crowdCode,r=a.traitCode,s=a.max_dimension_num;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={max_dimension_num:s},e=f.a.pickBy(e,function(t){return null!=t&&""!==t}),t.prev=2,t.next=5,_.a.get(g.a.apiDomain+"/crowds-analytics/"+n+"/items/"+r,{params:e,paramsSerializer:function(t){return v.a.stringify(t,{indices:!1})}});case 5:return i=t.sent,t.abrupt("return",i.data);case 9:t.prev=9,t.t0=t.catch(2);case 12:case"end":return t.stop()}},t,b,[[2,9]])})),function(t){return i.apply(this,arguments)}),C=(n=h()(d.a.mark(function t(a){var e,i,n=a.channelCode,r=a.mold;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},e=f.a.pickBy(e,function(t){return null!=t&&""!==t}),t.prev=2,t.next=5,_.a.get(g.a.apiDomain+"/crowds-analytics/"+n+"/items/"+r,{params:e,paramsSerializer:function(t){return v.a.stringify(t,{indices:!1})}});case 5:return i=t.sent,t.abrupt("return",i.data);case 9:t.prev=9,t.t0=t.catch(2);case 12:case"end":return t.stop()}},t,b,[[2,9]])})),function(t){return n.apply(this,arguments)}),w=(r=h()(d.a.mark(function t(a){var e,i,n=a.crowdCode;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},e=f.a.pickBy(e,function(t){return null!=t&&""!==t}),t.prev=2,t.next=5,_.a.get(g.a.apiDomain+"/crowds-analytics/"+n+"/configuration",{params:e,paramsSerializer:function(t){return v.a.stringify(t,{indices:!1})}});case 5:return i=t.sent,t.abrupt("return",i.data);case 9:t.prev=9,t.t0=t.catch(2);case 12:case"end":return t.stop()}},t,b,[[2,9]])})),function(t){return r.apply(this,arguments)}),x=(s=h()(d.a.mark(function t(a,e){var i;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=f.a.pickBy(e,function(t){return null!=t&&""!==t}),t.prev=1,t.next=4,_.a.get(""+a,{params:e,paramsSerializer:function(t){return v.a.stringify(t,{indices:!1})}});case 4:return i=t.sent,t.abrupt("return",i.data);case 8:t.prev=8,t.t0=t.catch(1);case 11:case"end":return t.stop()}},t,b,[[1,8]])})),function(t,a){return s.apply(this,arguments)}),D=(o=h()(d.a.mark(function t(a){var e,i,n=a.crowdCode,r=a.traitCode;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},e=f.a.pickBy(e,function(t){return null!=t&&""!==t}),t.prev=2,t.next=5,_.a.post(g.a.apiDomain+"/crowds-analytics/"+n+"/tracking/"+r+"/add",{params:e,paramsSerializer:function(t){return v.a.stringify(t,{indices:!1})}});case 5:return i=t.sent,t.abrupt("return",i.data);case 9:t.prev=9,t.t0=t.catch(2);case 12:case"end":return t.stop()}},t,b,[[2,9]])})),function(t){return o.apply(this,arguments)}),T=(c=h()(d.a.mark(function t(a){var e,i,n=a.crowdCode,r=a.traitCode;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e={},e=f.a.pickBy(e,function(t){return null!=t&&""!==t}),t.prev=2,t.next=5,_.a.delete(g.a.apiDomain+"/crowds-analytics/"+n+"/tracking/"+r,{params:e,paramsSerializer:function(t){return v.a.stringify(t,{indices:!1})}});case 5:return i=t.sent,t.abrupt("return",i.data);case 9:t.prev=9,t.t0=t.catch(2);case 12:case"end":return t.stop()}},t,b,[[2,9]])})),function(t){return c.apply(this,arguments)});a.a={getSexStatData:y,getTextData:C,getConfigData:w,getCommonData:x,addTrackingData:D,delTrackingData:T}},"EYK+":function(t,a){},J3zF:function(t,a){},JqEK:function(t,a){},MVrB:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"AdminCard",data:function(){return{state:{unknown:{color:"#808695",text:"未知"},down:{color:"#ed4014",text:"异常"},up:{color:"#19be6b",text:"正常"},starting:{color:"#ff9900",text:"启动中"}}}},props:{title:{type:String,default:""},data:{type:Array,default:function(){return[]}}},methods:{reStart:function(t){var a=this,e="/board/start-instances/"+t.id;this.$axios.post(""+this.$config.apiDomain+e).then(function(){a.$parent.getData()}).catch(function(){a.$parent.getData()})}}},n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"admin-box"},[e("div",{staticClass:"admin-title"},[e("span",[t._v(t._s(t.title))])]),t._v(" "),e("ul",{staticClass:"admin-list"},t._l(t.data,function(a,i){return e("li",{key:i},[e("span",{staticClass:"iconfont icon-server",class:a.state}),t._v(" "),e("div",{staticStyle:{flex:"1",color:"#17233D"}},[t._v(t._s(a.name))]),t._v(" "),e("div",{staticStyle:{flex:"1"}},[t._v(t._s(a.access_ip))]),t._v(" "),e("div",{staticStyle:{flex:"1"}},[e("span",{style:{color:t.state[a.state].color}},[t._v(t._s(t.state[a.state].text))]),t._v(" "),"down"==a.state&&"allow"==a.allow_start?e("Button",{staticClass:"td-btn-primary ml20",on:{click:function(e){t.reStart(a)}}},[t._v("启动")]):t._e()],1)])}))])},staticRenderFns:[]};var r={name:"Admin",data:function(){var t=this;return{listData:{},isShow:!1,msgTips:"数据加载中...",isLoading:!1,loadingOrNoData:"数据加载中...",gridList:{columns:[{title:"渠道名称",key:"channel_name",ellipsis:!0,tooltip:!0},{title:"渠道ID",key:"channel_code",ellipsis:!0,tooltip:!0},{title:"激活特性数量",key:"active_trait_count",ellipsis:!0,tooltip:!0},{renderHeader:function(a){return a("div",{style:{position:"relative",linehHeight:"40px"}},[a("span",{style:{paddingRight:"3px"}},"可释放资源数量"),a("Tooltip",{style:{display:t.isMember?"none":""},props:{"max-width":"300",content:"可释放资源指渠道内占据存储、索引空间的冗余信息，释放它们可以让系统更快速高效。",placement:"top",transfer:!0}},[a("i",{style:{"font-size":"14px"},attrs:{class:"fa fa-question-circle-o"}})])])},key:"not_active_trait_in_mapping_count"}],data:[]}}},components:{AdminCard:e("VU/8")(i,n,!1,function(t){e("fnWQ")},"data-v-d8a6eeee",null).exports},mounted:function(){var t=this;this.getData(),this.getResouceData();var a=setInterval(function(){t.getData()},6e4);this.$once("hook:beforeDestroy",function(){clearInterval(a),a=null})},methods:{getData:function(){var t=this;this.$axios.get(this.$config.apiDomain+"/board/monitor-instances").then(function(a){var e=a.data;if(t.isShow=!0,t.$lodash.isEmpty(e))return t.isShow=!1,void(t.msgTips="暂无服务监控配置");t.listData=e}).catch(function(){t.isShow=!1,t.msgTips="数据加载失败"})},getResouceData:function(){var t=this;this.isShowInput=!1,this.loadingOrNoData="数据加载中...",this.isLoading=!0;this.$axios.get(this.$config.apiDomain+"/sys/resource/resource-statistics/traits",{params:{rows:-1}}).then(function(a){var e=a.data;e.items.length||(t.loadingOrNoData="暂无数据"),t.gridList.data=t.clearData(e.items),t.isLoading=!1}).catch(function(){t.gridList.data=[],t.loadingOrNoData="数据加载失败",t.isLoading=!1})},clearData:function(t){var a=[];return t.forEach(function(t){a.push({channel_code:t.channel_code,channel_name:t.channel_name,active_trait_count:0==t.trait_resource.trait_limit_count?""+t.trait_resource.active_trait_count:t.trait_resource.active_trait_count+" / "+t.trait_resource.trait_limit_count,not_active_trait_in_mapping_count:t.trait_resource.not_active_trait_in_mapping_count})}),a}}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"page-warpper"},[e("div",{staticClass:"page-title bottom-shadow"},[t._v("\n        概览\n    ")]),t._v(" "),e("div",{staticClass:"page-content container-padding24"},[e("div",{staticClass:"f18 mb20"},[t._v("\n            服务监控\n        ")]),t._v(" "),t.isShow?e("Card",{attrs:{"dis-hover":"",padding:0}},t._l(t.listData,function(t,a,i){return e("AdminCard",{key:i,class:+i%2!=0?"admin-bg":"",attrs:{title:a,data:t}})})):e("Card",{staticClass:"error",attrs:{"dis-hover":""}},[e("p",[t._v(t._s(t.msgTips))])]),t._v(" "),e("div",{staticClass:"f18 mb20 mt20"},[t._v("\n            渠道特性资源监控\n        ")]),t._v(" "),e("Table",{staticClass:"smce-table-noscroll td-table-no-border",attrs:{loading:t.isLoading,"no-data-text":t.loadingOrNoData,columns:t.gridList.columns,data:t.gridList.data}})],1)])},staticRenderFns:[]};var o=e("VU/8")(r,s,!1,function(t){e("QGkR"),e("v6Uy")},"data-v-3d3739bb",null).exports,c={name:"ViewCard",props:{title:{type:String,default:""},subtitle:{type:String,default:""},amount:{type:Number,default:0},changeTitle:{type:String,default:""},changeNum:{type:Number,default:0}}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Card",{staticClass:"view-card-wrapper",attrs:{"dis-hover":""}},[e("p",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),e("Row",{staticClass:"change-status-wrapper"},[e("Col",{attrs:{span:"12"}},[e("div",[e("div",{staticClass:"num"},[t._v(t._s(t._f("formatAmount")(t.amount)))]),t._v("\n                "+t._s(t.subtitle)+"\n            ")])]),t._v(" "),e("Col",{attrs:{span:"12"}},[e("div",[e("div",{staticClass:"num"},[t._v(t._s(t._f("formatAmount")(t.changeNum)))]),t._v("\n                "+t._s(t.changeTitle)+"\n            ")])])],1)],1)},staticRenderFns:[]};var d=e("VU/8")(c,l,!1,function(t){e("7jK+")},"data-v-281b41ea",null).exports,u=e("yIQO"),h={name:"TrendChart",components:{Board:u.a},props:{chartHeight:{type:String,default:"276px"},tabArr:{type:Array,default:function(){return[{label:"累计趋势",name:"total"}]}},request:{type:Object,default:function(){return{url:"",params:{}}},validator:function(t){return!!t.url}}},data:function(){var t=this;return{canSend:!0,cacheData:null,tabVal:this.tabArr[0].name,radioVal:"one_week",radioArr:[{name:"近7天",val:"one_week"},{name:"近2周",val:"two_weeks"},{name:"近1个月",val:"one_month"},{name:"近3个月",val:"three_months"},{name:"近6个月",val:"six_months"},{name:"近1年",val:"one_year"}],boardData:{request:{url:this.request.url,params:{time_period:"one_week"},isSend:function(){return t.canSend},getData:function(a){return t.cacheData=a,a}},name:"date_str",field:"total",charts:["line"],chartOpt:{grid:{left:20,right:40},yAxis:{min:0}}}}},created:function(){var t=this.$config.debounce_wait;this.debounceChange=this.$lodash.debounce(this.change,t)},methods:{change:function(t){this.canSend=!0,this.boardData.data=null,this.boardData.request.params.time_period=t,this.radioVal=t,this.$refs.trend.change()},tabChange:function(t){this.canSend=!1,this.boardData.data=this.cacheData,this.boardData.field=t,this.$refs.trend.change()}}},p={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"trend-chart"},[e("Tabs",{staticClass:"trend-tab",attrs:{animated:!1,value:t.tabVal},on:{"on-click":t.tabChange}},t._l(t.tabArr,function(t){return e("TabPane",{key:t.name,attrs:{label:t.label,name:t.name}})})),t._v(" "),e("RadioGroup",{staticClass:"trend-radio",attrs:{type:"button",size:"small"},on:{"on-change":t.debounceChange},model:{value:t.radioVal,callback:function(a){t.radioVal=a},expression:"radioVal"}},t._l(t.radioArr,function(a){return e("Radio",{key:a.val,attrs:{label:a.val}},[t._v(t._s(a.name))])})),t._v(" "),e("board",{ref:"trend",staticClass:"trend-board",attrs:{data:t.boardData,hasLegend:!0,isShowText:!0,height:t.chartHeight}})],1)},staticRenderFns:[]};var f=e("VU/8")(h,p,!1,function(t){e("8Bkq"),e("mxAs")},"data-v-75c771c3",null).exports,m={name:"AdminInsight",components:{ViewCard:d,TrendChart:f},data:function(){return{loading:!1,data:[],tabArr:[{label:"累计趋势",name:"total"},{label:"新增趋势",name:"increase"}],request:{url:this.$config.apiDomain+"/board/history/user-count/tenant"}}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;this.loading=!0,this.$axios.get(this.$config.apiDomain+"/board/realtime/user-count/tenant").then(function(a){var e=a.data;t.loading=!1,t.data=e}).catch(function(){t.loading=!1})}}},v={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"page-warpper"},[e("div",{staticClass:"page-title bottom-shadow"},[t._v("\n        概览\n    ")]),t._v(" "),e("div",{staticClass:"admin-insight-home page-content container-padding24"},[e("div",{staticClass:"view-box card-nopb clearfix"},[t._l(t.data,function(t,a){return e("view-card",{key:a,staticClass:"card-list fl mb16",class:(1+a)%4==0?"":"mr16",attrs:{title:t.name,amount:t.values[0].total,subtitle:"实时累计用户数",changeTitle:"实时今日新增数",changeNum:t.values[0].increase}})}),t._v(" "),t.loading?e("div",{staticClass:"loading-box"},[t._v("\n                数据加载中...\n                "),e("Spin",{attrs:{size:"large",fix:""}})],1):t._e(),t._v(" "),t.loading||t.data.length?t._e():e("div",{staticClass:"loading-box"},[t._v("\n                暂无数据\n            ")])],2),t._v(" "),e("Card",{staticClass:"mt10 trend-chart-box card-nopadding",attrs:{"dis-hover":""}},[e("trend-chart",{attrs:{chartHeight:"300px",request:t.request,"tab-arr":t.tabArr}})],1)],1)])},staticRenderFns:[]};var _=e("VU/8")(m,v,!1,function(t){e("TawS")},"data-v-762774a3",null).exports,g=e("fZjL"),b=e.n(g),y=e("woOf"),C=e.n(y),w={name:"ViewCard",props:{shadow:{type:Boolean,default:!0},showActive:{type:Boolean,default:!1},showChange:{type:Boolean,default:!1},showTitleTooltip:{type:Boolean,default:!1},toolTipContent:{type:String,default:""},title:{type:String,default:""},subtitle:{type:String,default:""},amount:{type:Number,default:0},activeNum:{type:Number,default:0},activeRemain:{default:Number},activeLimitNum:{default:Number},frozenNum:{type:Number,default:0},activeName:{type:String,default:"激活"},frozenName:{type:String,default:"冻结"},activeStatus:{type:String,default:"success"},frozenStatus:{type:String,default:"default"},changeTitle:{type:String,default:""},percent:{type:[Number,String],default:""},changeNum:{type:Number,default:0},align:{type:String,default:""},titleFontSize:{type:String,default:"14px"},numFontSize:{type:String,default:"24px"},fontWeight:{type:String,default:"bold"},activelimit:{type:Boolean,default:!1},limitColor:{type:String,default:"#19be6b"},showLimitTooltip:{type:Boolean,default:!1},limitTipContent:{type:String}},computed:{isShowPercent:function(){return this.percent||""+this.percent}},methods:{handleClick:function(){this.$emit("handle-click")}}},x={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Card",{staticClass:"view-card-wrapper",attrs:{padding:0,"dis-hover":t.shadow},nativeOn:{click:function(a){return t.handleClick(a)}}},[e("p",{staticClass:"title",style:{"text-align":t.align,"font-size":t.titleFontSize}},[t._v(t._s(t.title)+"\n        "),t.showTitleTooltip?e("Tooltip",{attrs:{content:t.toolTipContent,placement:"right","max-width":"200",disabled:!t.toolTipContent}},[e("span",{staticClass:"iconfont icon-action_help_outline"})]):t._e()],1),t.subtitle?e("p",{staticClass:"subtitle"},[t._v(t._s(t.subtitle))]):t._e(),t._v(" "),e("p"),t._v(" "),e("p",{staticClass:"num total",style:{"text-align":t.align,"font-size":t.numFontSize,"font-weight":t.fontWeight}},[t._v("\n        "+t._s(t._f("formatAmount")(t.amount))+"\n    ")]),t._v(" "),t.showActive?e("div",{staticClass:"active-wrapper"},[e("span",{staticClass:"active"},[t.activelimit?[e("span",[t._v(t._s(t.activeName))]),t._v(" "),e("span",{staticClass:"limit-num"},[t._v(t._s(""+t.activeNum))]),t._v(" "),e("span",{staticStyle:{"font-size":"12px",color:"#666","margin-left":"4px"}},[t._v(t._s("( 余量："+t.activeRemain))]),t._v(" "),t.showLimitTooltip?e("Tooltip",{attrs:{content:t.limitTipContent,placement:"right","max-width":"240",disabled:!t.limitTipContent}},[e("span",{staticClass:"iconfont icon-action_help_outline",staticStyle:{"vertical-align":"middle","line-height":"16px",color:"#666"}}),t._v(" "),e("div",{staticStyle:{"font-size":"12px",color:"#666",display:"inline-block"}},[t._v(")")])]):t._e()]:[e("span",[t._v(t._s(t.activeName))]),t._v(" "),e("span",{staticClass:"num"},[t._v(t._s(t._f("formatAmount")(t.activeNum)))])]],2),t._v(" "),e("span",{staticClass:"frozen"},[t.activelimit?[e("span",[t._v(t._s(t.frozenName))]),t._v(" "),e("span",{staticClass:"limit-num"},[t._v(t._s(t.frozenNum))])]:[e("span",[t._v(t._s(t.frozenName))]),t._v(" "),e("span",{staticClass:"num"},[t._v(t._s(t._f("formatAmount")(t.frozenNum)))])]],2)]):t._e(),t._v(" "),t.showChange?e("Row",{staticClass:"change-status-wrapper"},[e("Col",{attrs:{span:"8"}},[t._v(t._s(t.changeTitle))]),t._v(" "),t.isShowPercent?e("Col",{attrs:{span:"8"}},[e("Icon",{staticClass:"arrow-icon",attrs:{type:"md-arrow-round-up"}}),t._v(" "),e("span",[t._v(t._s(t.percent)+"%")])],1):t._e(),t._v(" "),e("Col",{staticClass:"num"},[t._v(t._s(t._f("formatAmount")(t.changeNum)))])],1):t._e()],1)},staticRenderFns:[]};var D={name:"OverviewTab",components:{ViewCard:e("VU/8")(w,x,!1,function(t){e("ZYHV")},"data-v-fd13986e",null).exports},props:{tabTitle:{type:String,default:"标题"},traitTooltip:{type:String,default:""},crowdTooltip:{type:String,default:""},auditTooltip:{type:String,default:""}},created:function(){this.getData(),this.getAuditNum()},data:function(){return{auditNum:0,colorArr:["#19be6b","#f90","#ed4014"],channelInfo:{trait:{title:"特性",total:0,active:0,freeze:0,to:"trait",toolTipContent:this.traitTooltip,active_limitation:0,active_remain:0,showLimitTooltip:!0,limitTipContent:"指渠道内可激活特性的剩余数量",color:"#19be6b"},crowd:{title:"人群",total:0,active:0,freeze:0,to:"crowd",toolTipContent:this.crowdTooltip,active_limitation:0,active_remain:0,showLimitTooltip:!0,limitTipContent:"指渠道内可激活人群的剩余数量",color:"#19be6b"},audit:{title:"待审核",total:0,active:0,freeze:0,activeName:"人群",frozenName:"特性",activeStatus:"processing",frozenStatus:"success",to:"channelaudit",toolTipContent:this.auditTooltip}}}},methods:{handleClick:function(t){var a={name:t};"channelaudit"===t&&(a=C()({},a,{params:{status:"pending"}})),this.$router.push(a)},getData:function(){var t=this,a=this.$config.apiDomain+"/board/resources/preview";this.$axios.get(a).then(function(a){var e=a.data;b()(t.channelInfo).forEach(function(a){var i=e[a];if(i&&i.active_percentage){var n=i.active_percentage;i.color=n>=0&&n<=80?t.colorArr[0]:n>80&&n<100?t.colorArr[1]:n>=100?t.colorArr[2]:t.colorArr[0]}t.channelInfo[a]=C()(t.channelInfo[a],e[a])})})},setTipContent:function(t,a){var e={trait:"特性",crowd:"人群"},i="";switch(a){case 0:i="渠道内激活的"+e[t]+"总数占渠道"+e[t]+"总数的80%以下，此时渠道内激活"+e[t]+"数量处于正常状态";break;case 1:i="渠道内激活的"+e[t]+"总数占渠道"+e[t]+"总数的80%~100%，此时渠道内激活"+e[t]+"数量已经接近饱和。系统离线更新特性人群的时间可能较长";break;case 2:i="渠道内激活的"+e[t]+"总数达到或超过渠道限定可激活"+e[t]+"数，此时渠道内激活"+e[t]+"数量已经非常饱和。系统离线更新特性人群的时间可能会很长"}return i},getAuditNum:function(){var t=this,a=this.$config.apiDomain+"/board/audit/number";this.$axios.get(a,{params:{audit_status:"pending"}}).then(function(a){var e=a.data;(e=e||{}).details=e.details||{},t.channelInfo.audit=C()({},t.channelInfo.audit,{total:e.total||0,active:e.details.crowd||0,freeze:e.details.trait||0})})}}},T={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Card",{staticClass:"overview-tab",attrs:{"dis-hover":"",bordered:!1,padding:0}},[e("Row",{staticClass:"channel-overview"},t._l(t.channelInfo,function(a,i){return e("Col",{key:i,attrs:{span:24/Object.keys(t.channelInfo).length}},[e("view-card",{staticClass:"channel-card",attrs:{shadow:!1,title:a.title,amount:a.total,showActive:"",activeNum:a.active,frozenNum:a.freeze,activeName:a.activeName,frozenName:a.frozenName,activeStatus:a.activeStatus,frozenStatus:a.frozenStatus,activeRemain:a.active_remain,activelimit:!!a.active_limitation,activeLimitNum:a.active_limitation,showLimitTooltip:a.showLimitTooltip,limitTipContent:a.limitTipContent,limitColor:a.color,showTitleTooltip:"",toolTipContent:a.toolTipContent},on:{"handle-click":function(e){t.handleClick(a.to)}}})],1)}))],1)},staticRenderFns:[]};var S=e("VU/8")(D,T,!1,function(t){e("EYK+")},"data-v-218e8dc6",null).exports,k={name:"UserAmount",components:{TrendChart:f},props:{tabTitle:{type:String,default:""},tabArr:{type:Array},isShowToday:{type:Boolean,default:!1}},created:function(){this.getRealTimeData()},data:function(){return{data:{total:0,increase:0},request:{url:this.$config.apiDomain+"/board/history/user-count/channel"}}},methods:{getRealTimeData:function(){var t=this,a=this.$config.apiDomain+"/board/realtime/user-count/channel";this.$axios.get(a).then(function(a){var e=a.data;if(e[0]&&e[0].values){var i=e[0].values[0];t.data={total:i.total,increase:i.increase}}})}}},$={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"user-amount"},[e("Row",{staticClass:"content-wrapper"},[e("Col",{staticClass:"chart-wrapper",attrs:{span:"19"}},[e("Card",{attrs:{"dis-hover":""}},[e("trend-chart",{attrs:{"tab-arr":t.tabArr,request:t.request}})],1)],1),t._v(" "),"ROLE_C_ADMIN"==t.$config.login_info.auth_info.role_id?e("Col",{staticClass:"real-time-wrapper",attrs:{span:"5"}},[e("Card",{staticClass:"num",attrs:{"dis-hover":""}},[e("p",{staticClass:"total"},[t._v(t._s(t._f("formatAmount")(t.data.total)))]),t._v(" "),e("p",[t._v("实时累计用户数")])]),t._v(" "),e("Card",{staticClass:"num",attrs:{"dis-hover":""}},[e("p",{staticClass:"total"},[t._v(t._s(t._f("formatAmount")(t.data.increase)))]),t._v(" "),e("p",[t._v("实时今日新增数")])])],1):t._e(),t._v(" "),"ROLE_D_ADMIN"==t.$config.login_info.auth_info.role_id||"ROLE_D_OPERATOR"==t.$config.login_info.auth_info.role_id?e("Col",{staticClass:"real-time-wrapper",attrs:{span:"5"}},[e("Card",{staticClass:"num",attrs:{"dis-hover":""}},[e("p",{staticClass:"total-admin"},[t._v(t._s(t._f("formatAmount")(t.data.total)))]),t._v(" "),e("p",[t._v("实时累计用户数")])])],1):t._e()],1)],1)},staticRenderFns:[]};var A=e("VU/8")(k,$,!1,function(t){e("rHdL")},"data-v-489f0544",null).exports,N=e("Dd8w"),R=e.n(N),O={name:"traitAnalyse",components:{TraitInput:e("d32x").a,Board:u.a},props:{visible:{type:Boolean,default:!1},noDataMsg:{type:String,default:"渠道管理员未添加任何特性，若需要添加实时特性分析，请联系渠道管理员"}},created:function(){this.getChartData()},computed:{filterIds:function(){return this.filterTraitId(this.traitList)}},data:function(){var t={include_sub_catalog:!1,authorized:!1,lifecycle_status:"active",data_type:this.$config.data_type_list};return{spinShow:!0,URI:{searchParams:R()({},t),catalogsParams:R()({},t),traitsParams:R()({},t),search:this.$config.apiDomain+"/searcher/traits-and-crowds",catalogs:this.$config.apiDomain+"/catalogs",traits:this.$config.apiDomain+"/traits"},traitList:[]}},methods:{filterTraitId:function(t){var a=[];for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=t[e].data[0];a.push({code:i.code,scope:i.scope})}return a},dealData:function(t){var a=t||{},e={data:{},model:"",charts:["pie","v_bar"],chartOpt:{grid:{left:30,right:40}}};return b()(a).forEach(function(i){a[i]=C()({},e,{data:t[i]}),a[i]&&"Address"===a[i].data[0].data_type?a[i]=C()(a[i],{type:"address",data_type:"address",isShowNonExistent:!0}):a[i]=C()(a[i],{type:"chart"})}),a},getChartData:function(){var t=this;this.spinShow=!0;var a=this.$config.apiDomain+"/board/portraits";this.$axios.get(a).then(function(a){var e=a.data;t.spinShow=!1,t.traitList=t.dealData(e)}).catch(function(){t.spinShow=!1})},createTrait:function(t){var a=this;this.spinShow=!0;var e=this.$config.apiDomain+"/board/portraits/traits/"+t.value[0];this.$axios.post(e).then(function(t){var e=t.data;if(a.spinShow=!1,e&&e[0]){var i=e[0].name,n={};n[i]=e;var r=a.dealData(n);a.$set(a.traitList,i,r[i])}a.$Message.success("已添加")}).catch(function(){a.spinShow=!1})},deleteTrait:function(t,a){var e=this,i=t.data[0].code;this.$Modal.confirm({title:"确认删除此图表吗？",content:"名称："+a+"<br><br>删除后，节点角色的概览页也将不再展示此图表。",onOk:function(){var t=e.$config.apiDomain+"/board/portraits/traits/"+i;e.spinShow=!0,e.$axios.delete(t).then(function(){e.spinShow=!1,e.$delete(e.traitList,a),e.$Message.success("已删除")}).catch(function(){e.spinShow=!1})}})}}},L={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"trait-analyse no-pm"},[e("Row",{staticStyle:{height:"32px",margin:"24px 2px"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[e("Col",{staticClass:"title"},[t._v("特性实时分析")]),t._v(" "),e("Col",[t.visible?e("TraitInput",{attrs:{disabled:Object.keys(t.traitList).length>=6,btnType:!0,btnColor:"primary",filterIds:t.filterIds,URI:t.URI},on:{"on-change":t.createTrait}}):t._e()],1)],1),t._v(" "),e("Row",[t.spinShow?e("Spin",{attrs:{fix:""}}):t._e(),t._v(" "),e("div",[Object.keys(t.traitList).length?e("Row",{staticClass:"chart-wrapper"},t._l(t.traitList,function(a,i){return e("Col",{key:i,staticClass:"single-card",attrs:{span:"12"}},[e("Card",{attrs:{"dis-hover":""}},[e("board",{ref:"board",refInFor:!0,attrs:{hasCheckbox:"",hasDeleteBtn:t.visible,title:i,data:a,offsetX:"0px",offsetY:"-31px"},on:{remove:function(e){t.deleteTrait(a,i)}}})],1)],1)})):e("Row",[e("Card",{attrs:{"dis-hover":""}},[e("Col",{staticClass:"no-msg"},[t._v(t._s(t.noDataMsg))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var E=e("VU/8")(O,L,!1,function(t){e("02PY"),e("O3kH")},"data-v-0567e9d0",null).exports,z={name:"Channel",components:{OverviewTab:S,UserAmount:A,TraitAnalyse:E},data:function(){return{tabArr:[{label:"累计趋势",name:"total"},{label:"新增趋势",name:"increase"}]}}},I={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"page-warpper"},[a("div",{staticClass:"page-title bottom-shadow"},[this._v("\n        概览\n    ")]),this._v(" "),a("div",{staticClass:"channel-home page-content container-padding24"},[a("overview-tab",{attrs:{tabTitle:"渠道资源总数",traitTooltip:"当前渠道内所有特性的总数",crowdTooltip:"当前渠道内所有人群的总数",auditTooltip:"当前渠道内所有待审核的总数"}}),this._v(" "),a("user-amount",{staticClass:"mt24",attrs:{tabTitle:"渠道用户数","tab-arr":this.tabArr,isShowToday:""}}),this._v(" "),a("trait-analyse",{attrs:{visible:"",noDataMsg:"未添加任何特性，若需要添加实时特性分析，请点击右上方添加按钮"}})],1)])},staticRenderFns:[]},V=e("VU/8")(z,I,!1,null,null,null).exports,B={name:"Node",components:{OverviewTab:S,UserAmount:A,TraitAnalyse:E},data:function(){return{}}},M={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"page-warpper"},[a("div",{staticClass:"page-title bottom-shadow"},[this._v("\n        概览\n    ")]),this._v(" "),a("div",{staticClass:"node-home page-content container-padding24"},[a("overview-tab",{attrs:{tabTitle:"节点资源总数",traitTooltip:"当前节点内所有特性的总数（不包含公共的和下级节点）",crowdTooltip:"当前节点内所有人群的总数（不包含下级节点）",auditTooltip:"当前节点内所有待审核的总数"}}),this._v(" "),a("user-amount",{staticClass:"mt24",attrs:{tabTitle:"节点用户数"}}),this._v(" "),a("trait-analyse")],1)])},staticRenderFns:[]};var U=e("VU/8")(B,M,!1,function(t){e("pRn1")},"data-v-cb5deddc",null).exports,F={name:"NodeOperator",components:{UserAmount:A,TraitAnalyse:E},data:function(){return{}}},q={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"page-warpper"},[a("div",{staticClass:"page-title bottom-shadow"},[this._v("\n        概览\n    ")]),this._v(" "),a("div",{staticClass:"node-operator-home page-content container-padding24"},[a("user-amount",{attrs:{tabTitle:"节点用户数"}}),this._v(" "),a("trait-analyse")],1)])},staticRenderFns:[]};var P=e("VU/8")(F,q,!1,function(t){e("pTa3")},"data-v-318ca8b6",null).exports,H={name:"Overview",components:{Admin:o,AdminInsight:_,Channel:V,Node:U,NodeOperator:P},data:function(){return{userId:this.$config.login_info.auth_info.role_id,roleMap:{ROLE_C_ADMIN:V,ROLE_T_ADMIN:o,ROLE_T_VIEWER:_,ROLE_D_ADMIN:U,ROLE_D_OPERATOR:P}}}},j={render:function(){var t=this.$createElement;return(this._self._c||t)(this.roleMap[this.userId],{tag:"component"})},staticRenderFns:[]},W=e("VU/8")(H,j,!1,null,null,null);a.default=W.exports},O3kH:function(t,a){},QGkR:function(t,a){},TawS:function(t,a){},ZYHV:function(t,a){},fnWQ:function(t,a){},mxAs:function(t,a){},pRn1:function(t,a){},pTa3:function(t,a){},rHdL:function(t,a){},v6Uy:function(t,a){},yIQO:function(t,a,e){"use strict";var i=e("GxD7"),n=e.n(i),r=e("exGp"),s=e.n(r),o=e("1zT7"),c=e("CaBG"),l=e("7+uW"),d={props:{data:{type:Object,default:function(){return{}}},downList:{type:Array,default:function(){return[]}},offsetX:{type:String,default:"0"},offsetY:{type:String,default:"-34px"},tWid:{type:String,default:"100%"},title:{type:String,default:""},isReserveTitle:{type:Boolean,default:!0},width:{type:String,default:"100%"},height:{type:String,default:"300px"},isShowText:{type:Boolean,default:!0},notDataMsg:{type:String,default:"暂无数据"},hasLegend:{type:Boolean,default:!0},hasCheckbox:{type:Boolean,default:!1},hasDeleteBtn:{type:Boolean,default:!1}},data:function(){return{isShowAddressDetail:!1,mol:null,isNoValue:!0,chartType:"",barData:{model:"",type:[],mapOpt:null},dt:[],loading:!0,hasData:!1}},components:{charts:o.a},mounted:function(){this.init()},computed:{hasTitle:function(){var t=this.data||{},a=null!=this.title&&""!=this.title.trim();return this.isReserveTitle&&(a||t.charts&&t.charts.length>1)||!this.isReserveTitle&&a},isShowChart:function(){return!(!this.hasData&&this.isShowText)},hasSelect:function(){return this.barData.type.length>1&&"address"!=this.data.type},isShowMore:function(){return this.$slots.item},hasDelSlot:function(){return!!this.$slots.del}},methods:{init:function(){if(this.data){this.loading=!0;var t=this.data||{};t&&t.data&&this.addSpace(t.data[0].values);var a=t.type;""==(a=null==a?"":(""+a).trim().toLocaleLowerCase())&&(a="chart",t.type="chart"),t.charts&&0!=t.charts.length||(this.data.charts=["v_bar"]),"chart"==a||"address"==a||"text"==a?t.data?this.branchType(t.data):this.getCommonData():(t.type="unknown",this.loading=!1)}},changeAddressDetail:function(){this.isShowAddressDetail=!this.isShowAddressDetail},addSpace:function(t){t.forEach(function(t){"$missing"===t.label&&(t.name=t.name.trim()+" ",t.tmp_board_name&&(t.tmp_board_name=t.tmp_board_name.trim()+" "))})},clickMore:function(t){t<0||this.$emit("clickMore",t)},remove:function(){this.$emit("remove")},changeType:function(t){this.barData.model=t,this.$emit("changeType",t),this.chartType=t,this.$refs.chart&&this.$refs.chart.change&&this.$refs.chart.change()},changeValue:function(t){this.isNoValue=t,this.data.data?this.setBarData(this.data.data):this.getCommonData(),this.chartType&&(this.barData.model=this.chartType)},branchType:function(t){t=t||{};var a=(this.data||{}).type;"chart"==(a=null==a?"":(""+a).trim().toLocaleLowerCase())?this.setBarData(t):"address"==a?this.setMap(t):"text"==a&&(this.dt=t||{}),this.loading=!1},getItems:function(t){return t||[]},getValues:function(t){return(t=t||{})[this.data.values||"values"]||[]},setMap:function(t){var a=this,e=l.default.filter("formatAmount"),i=this.data||{},n=this,r=[],s=[],o=n.getItems(t),c=null;n.barData.model="map",n.hasData=!1,o.forEach(function(t){n.getValues(t).map(function(t){var e=t.value,i=t.name;t.name=t[a.data.name||"name"],t.value=t[a.data.field||"value"],t.tmp_board_name=i,t.tmp_board_value=e,n.hasData=!0,r.push(t),s.push(t.value),"没有值"==t.name&&(c=t)})}),this.barData.mapOpt={title:{text:"",subtext:!0!==i.isShowNonExistent?"":c?c.name+"："+c.value+(null==i.unit?"人":i.unit):"",bottom:"0px",left:"center"},tooltip:{trigger:"item",formatter:function(t){return(t.name?t.name:"-")+"："+(isNaN(t.value)?"-":t.value+(null==i.unit?"人":i.unit))}},visualMap:{min:Math.min.apply(Math,s),max:Math.max.apply(Math,s),left:"left",top:"bottom",text:["高","低"],calculable:!0,inRange:{color:["#b3d9ff","#3399ff"]},controller:{outOfRange:{color:"#EEEEEE"}},formatter:function(t){return""+e(t)}},series:[{name:null==i.mapTitle?"":i.mapTitle,type:"map",mapType:"china",data:r,itemStyle:{normal:{borderWidth:1,borderColor:"rgba(0,0,0,0.1)",color:"#fff",label:{show:!1}},emphasis:{borderWidth:0,borderColor:"rgba(0,0,0,0.1)",areaColor:"#2b85e4",label:{show:!1}}}}]},n.$nextTick(function(){n.$refs.chart&&n.$refs.chart.change&&n.$refs.chart.change()})},setBarData:function(t){var a=this,e=this;e.hasData=!1;var i=this.$lodash.cloneDeep(t),n=null;this.isNoValue?(i.map(function(t){t.values=t.values.filter(function(t){return"$missing"!==t.label})}),n=e.getItems(i)):n=e.getItems(t);var r=[],s=[],o=[],c=[],l=this.$lodash.cloneDeep(n);if(this.isNoValue&&(n=l.filter(function(t){return"$missing"!==t.label})),this.addSpace(n),n.map(function(t,i){a.addSpace(t.values);var n=e.getValues(t),l={};c.push(t.name),l.name=t.name,l.data=[],s.push(l),n.map(function(t){t=t||{},e.hasData=!0;var n=t.value,s=t.name;t.name=t[a.data.name||"name"],t.value=t[a.data.field||"value"],t.tmp_board_name=s,t.tmp_board_value=n,l.data.push(t),0==i&&r.push(t.name),0==i&&o.push(t)})}),!e.hasData){var d={value:0,name:"无"};r=["无"],s=[d],o=[d]}e.barData.id=0,e.barData.data={xAxisData:r,yAxisData:{type:"value"},seriesData:s,pieSeriesData:o,formatter:this.data.formatter,legend:c,chartOpt:this.data.chartOpt},e.data.charts.map(function(t,a){0==a&&(e.barData.type=[],e.barData.model=e.data.charts.indexOf(e.data.model)>-1?e.data.model:t),"v_bar"==t&&e.barData.type.push({value:"v_bar",label:"纵向柱状图"}),"h_bar"==t&&e.barData.type.push({value:"h_bar",label:"横向柱状图"}),"line"==t&&e.barData.type.push({value:"line",label:"线形图"}),"pie"==t&&e.barData.type.push({value:"pie",label:"饼状图"})}),e.$nextTick(function(){e.$refs.chart&&e.$refs.chart.change&&e.$refs.chart.change()})},getCommonData:function(){var t=this;s()(n.a.mark(function a(){var e,i,r,s;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.loading=!0,e=t.data.request||{},i=e.isSend||function(){return!0},null!=e.url&&""!=e.url.trim()&&!1!==i(e.params||{},e)){a.next=7;break}return t.loading=!1,a.abrupt("return");case 7:return a.next=9,c.a.getCommonData(e.url,e.params);case 9:r=a.sent,s="function"==typeof e.getData?e.getData(r)||[]:r,t.branchType(s),t.loading=!1,a.next=19;break;case 15:a.prev=15,a.t0=a.catch(0),t.loading=!1;case 19:case"end":return a.stop()}},a,this,[[0,15]])}))()},change:function(){this.init()}},watch:{data:function(){var t=this;this.$nextTick(function(){t.init()})}}},u={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{class:{"ui-board-box":!0,"ui-board-box-nt":!t.title},style:{width:t.width,height:t.height}},[t.hasTitle?e("h3",{staticClass:"ui-board-box-title",style:{width:t.tWid}},[t._v(t._s(t.title))]):t._e(),t._v(" "),e("div",{style:{position:"relative",height:t.hasTitle?"calc("+t.height+" - 30px)":t.height,width:"100%"}},[t.loading?e("div",{staticClass:"ui-board-box-content"},[e("Spin",{attrs:{size:"large",fix:""}})],1):t.loading||"unknown"!=t.data.type?e("div",{staticClass:"ui-board-box-content"},[e("div",{staticClass:"ui-board-box-toolbar",style:{top:t.offsetY,right:t.offsetX}},["address"!=t.data.type||t.isShowAddressDetail?t._e():e("div",{staticClass:"icon iconfont ui-board-box-toolbar-item icon-editor_format_list_bulleted",on:{click:function(a){t.changeAddressDetail()}}}),t._v(" "),"address"==t.data.type&&t.isShowAddressDetail?e("div",{staticClass:"icon iconfont ui-board-box-toolbar-item icon-address_outlined",on:{click:function(a){t.changeAddressDetail()}}}):t._e(),t._v(" "),t._l(t.barData.type,function(a){return a.value!=t.barData.model?e("div",{staticClass:"icon iconfont ui-board-box-toolbar-item",class:{"icon-editor_pie_chart_outline":"pie"==a.value,"icon-social_poll":"v_bar"==a.value},on:{click:function(e){t.changeType(a.value)}}}):t._e()}),t._v(" "),t.hasDelSlot?t._t("del"):t.hasDeleteBtn?e("div",{staticClass:"icon iconfont ui-board-box-toolbar-item icon-action_delete_outline",on:{click:t.remove}}):t._e(),t._v(" "),e("Dropdown",{staticStyle:{height:"24px"},attrs:{transfer:"",trigger:"click"},on:{"on-click":t.clickMore}},[t.isShowMore||t.hasCheckbox&&"address"!=t.data.type?e("Icon",{staticClass:"ui-board-box-toolbar-item",staticStyle:{color:"#2d8cf0"},attrs:{type:"md-more"}}):t._e(),t._v(" "),e("DropdownMenu",{staticClass:"ui-board-dropdown",attrs:{slot:"list"},slot:"list"},[t.hasCheckbox&&"address"!=t.data.type?e("DropdownItem",{attrs:{name:"-1"}},[e("Checkbox",{staticClass:"is-no-value",on:{"on-change":function(a){return t.changeValue(a)}},model:{value:t.isNoValue,callback:function(a){t.isNoValue=a},expression:"isNoValue"}},[t._v("隐藏空值")])],1):t._e(),t._v(" "),t._t("item")],2)],1)],2),t._v(" "),t.isShowChart?e("charts",{ref:"chart",staticClass:"ui-board-box-charts",attrs:{data:t.barData,isShowAddressDetail:t.isShowAddressDetail,legendPaddingTop:t.hasTitle?12:0,hasLegend:t.hasLegend,width:t.width,height:t.hasTitle?"calc("+t.height+" - 30px)":t.height}}):e("div",{staticClass:"ui-board-box-msg",style:{lineHeight:t.hasTitle?"calc("+t.height+" - 30px)":t.height}},[t._v("\n                    "+t._s(t.notDataMsg)+"\n                ")])],1):e("div",{staticClass:"ui-board-box-content "},[e("p",{staticClass:"ui-board-box-unknown"},[t._v("\n                    配置信息错误!\n                ")])])])])])},staticRenderFns:[]};var h=e("VU/8")(d,u,!1,function(t){e("J3zF"),e("JqEK")},"data-v-0afc295d",null);a.a=h.exports}});