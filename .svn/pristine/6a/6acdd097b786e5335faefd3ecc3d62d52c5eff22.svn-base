webpackJsonp([34],{"FAs+":function(t,e){},FL6E:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"whole-order",data:function(){return{gaugeWidth:0}},props:{title:{type:String,required:!0},allData:{type:Object,required:!0},loading:{type:Boolean,default:!0},vip:{type:String,default:"total"}},created:function(){},mounted:function(){if(this.allData){this.resize();var t=this.echarts.init(document.getElementById("main_1")),e=this.echarts.init(document.getElementById("main_2")),a=this.echarts.init(document.getElementById("main_3")),i=this.echarts.init(document.getElementById("main_4")),n={color:"red",title:{text:"回访率"},tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[{name:"回访任务量",type:"gauge",title:{color:"#333"},detail:{fontSize:20,offsetCenter:[0,"55%"],formatter:"{value}%"},data:[{value:(100*(this.allData.visited_vip_count/this.allData.total_vip_count||0)).toFixed(2),name:"完成率"}],axisLine:{show:!0,lineStyle:{width:30,shadowBlur:0,color:[[(this.allData.visited_vip_count/this.allData.total_vip_count||0).toFixed(2)||0,"#0E7CE2"],[1,"#FF8352"]]}}}]},o=["#0E7CE2","#FF8352"],l=[{name:"已回访统计",value:this.allData.visited_vip_count||0},{name:"未回访统计",value:this.allData.total_vip_count-this.allData.visited_vip_count||0}],s=function(t){if(!t)return 0;return t.toString().replace(/(?=(\B)(\d{3})+$)/g,",")},r=l.reduce(function(t,e){return t+1*e.value},0),d={backgroundColor:"#fff",color:o,title:[{text:"{name|回访任务总量}\n{val|"+s(r)+"}",top:"center",left:"center",textStyle:{rich:{name:{fontSize:14,fontWeight:"normal",color:"#666666",padding:[10,0]},val:{fontSize:32,fontWeight:"bold",color:"#333333"}}}}],series:[{type:"pie",radius:["55%","70%"],center:["50%","50%"],data:l,hoverAnimation:!1,itemStyle:{normal:{borderColor:"#fff",borderWidth:2}},labelLine:{normal:{length:10,length2:100,lineStyle:{color:"#e6e6e6"}}},label:{normal:{formatter:function(t){return"{icon|●}{name|"+t.name+"}{value|"+s(t.value)+"}"},padding:[0,-100,25,-100],rich:{icon:{fontSize:16},name:{fontSize:14,padding:[0,10,0,4],color:"#666666"},value:{fontSize:18,fontWeight:"bold",color:"#333333"}}}}}]},c={title:{text:"导购参与率"},tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[{name:"导购参与率",type:"gauge",title:{color:"#333"},detail:{fontSize:20,offsetCenter:[0,"55%"],formatter:"{value}%"},data:[{value:(100*(this.allData.visited_guide_count/this.allData.total_guide_count||0)).toFixed(2),name:"完成率"}],axisLine:{show:!0,lineStyle:{width:30,shadowBlur:0,color:[[(this.allData.visited_guide_count/this.allData.total_guide_count||0).toFixed(2),"#0E7CE2"],[1,"#FF8352"]]}}}]},u=[{name:"已回访导购人数",value:this.allData.visited_guide_count||0},{name:"未回访导购人数",value:this.allData.total_guide_count-this.allData.visited_guide_count||0}],h=u.reduce(function(t,e){return t+1*e.value},0),p={backgroundColor:"#fff",color:o,title:[{text:"{name|回访任务总量}\n{val|"+s(h)+"}",top:"center",left:"center",textStyle:{rich:{name:{fontSize:14,fontWeight:"normal",color:"#666666",padding:[10,0]},val:{fontSize:32,fontWeight:"bold",color:"#333333"}}}}],series:[{type:"pie",radius:["55%","70%"],center:["50%","50%"],data:u,hoverAnimation:!1,itemStyle:{normal:{borderColor:"#fff",borderWidth:2}},labelLine:{normal:{length:10,length2:130,lineStyle:{color:"#e6e6e6"}}},label:{normal:{formatter:function(t){return"{icon|●}{name|"+t.name+"}{value|"+s(t.value)+"}"},padding:[0,-100,25,-100],rich:{icon:{fontSize:16},name:{fontSize:14,padding:[0,10,0,4],color:"#666666"},value:{fontSize:18,fontWeight:"bold",color:"#333333"}}}}}]};t.setOption(n),e.setOption(d),a.setOption(c),i.setOption(p),window.addEventListener("resize",this.resize)}else this.loading=!0},beforeDestroy:function(){window.removeEventListener("resize",this.resize)},methods:{resize:function(){this.gaugeWidth=this.$refs.win.clientWidth-32,document.getElementById("main_1").style.width=.5*this.gaugeWidth+"px",document.getElementById("main_2").style.width=.5*this.gaugeWidth+"px",document.getElementById("main_1").style.height="300px",document.getElementById("main_2").style.height="300px",document.getElementById("main_3").style.width=.5*this.gaugeWidth+"px",document.getElementById("main_4").style.width=.5*this.gaugeWidth+"px",document.getElementById("main_3").style.height="300px",document.getElementById("main_4").style.height="300px"}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"win",staticClass:"whole-order flex",staticStyle:{overflow:"hidden"}},[a("Row",{staticStyle:{width:"100%",display:"flex"}},[a("Card",{staticStyle:{flex:"1"},attrs:{"dis-hover":""}},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("回访任务量统计")]),t._v(" "),t.allData?a("Row",[a("i-col",{attrs:{span:"24"}},[a("div",{staticStyle:{margin:"auto"},attrs:{id:"main_1"}})]),t._v(" "),a("i-col",{attrs:{span:"24"}},[a("div",{staticStyle:{margin:"auto"},attrs:{id:"main_2"}})])],1):a("no-data")],1),t._v(" "),a("Card",{staticStyle:{flex:"1"},attrs:{"dis-hover":""}},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("回访导购统计")]),t._v(" "),t.allData?a("Row",[a("i-col",{attrs:{span:"24"}},[a("div",{staticStyle:{margin:"auto"},attrs:{id:"main_3"}})]),t._v(" "),a("i-col",{attrs:{span:"24"}},[a("div",{staticStyle:{margin:"auto"},attrs:{id:"main_4"}})])],1):a("no-data")],1)],1)],1)},staticRenderFns:[]};var o={data:function(){return{title:"",allData:[],menu:[],active_name:0,loading:!1,dimension:["total","nonVip","oldVip","newVip"],show:!1,ditchList:[],areaList:[],shopList:[],queryChannelOptions:{brand:"",area:"",shop:""},queryOptions:{brand:"",area:"",shop:""}}},components:{ChartPage:a("VU/8")(i,n,!1,function(t){a("FAs+")},"data-v-34d15c59",null).exports},created:function(){var t=this;this.$https.analysisManagement.allQueryType().then(function(e){t.ditchList=e[0].data.data.map(function(t){return{label:t.name,value:t.orgId}}),t.ditchList.unshift({label:"选择渠道",value:"0"}),t.areaList=e[1].data.data.map(function(t){return{label:t.name,value:t.orgId}}),t.areaList.unshift({label:"选择门店",value:"0"})}),this.menu=["回访数据"],this.getData()},mounted:function(){},methods:{changeStroe:function(){var t=this;this.$https.analysisManagement.queryChannelOptions({queryType:"stroe",brand:this.queryOptions.brand,area:this.queryOptions.area}).then(function(e){t.queryChannelOptions.shop="",t.queryOptions.shop="",t.shopList=e.data.data.map(function(t){return{label:t.storeName,value:t.storeNo}})})},getData:function(){var t=this;this.show=!1,this.$https.visitKanban.detail({code:this.$route.query.f_id,data:{area:this.queryOptions.area&&this.queryOptions.area.split(),brand:this.queryOptions.brand&&this.queryOptions.brand.split(),shop:this.queryOptions.shop}}).then(function(e){t.allData=e.data.data,t.show=!0})},ditchChange:function(t){this.queryOptions.brand=this.find(this.ditchList,"value",t)&&(this.find(this.ditchList,"value",t).label||""),this.changeStroe()},areaChange:function(t){this.queryOptions.area=this.find(this.areaList,"value",t)&&(this.find(this.areaList,"value",t).label||""),this.changeStroe()},shopChange:function(t){var e=[];for(var a in t)e.push(this.find(this.shopList,"value",t[a])&&(this.find(this.shopList,"value",t[a]).label||""));this.queryOptions.shop=e},back:function(){this.$router.go(-1)},find:function(t,e,a){return t.find(function(t){return t[e]===a})},inquire:function(){this.getData()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Row",{staticStyle:{padding:"16px 24px","background-color":"white","margin-top":"15px"},attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("i-col",{staticStyle:{"background-color":"white"}},[a("span",{on:{click:t.back}},[a("Icon",{staticStyle:{"margin-top":"-5px","margin-right":"5px"},attrs:{type:"md-arrow-back",size:"24",color:"rgba(23,35,61,0.55)"}})],1),t._v(" "),a("span",{staticStyle:{"font-size":"20px"}},[t._v("\n               回访看板\n            ")])])],1),t._v(" "),a("div",{staticClass:"slide-scroll-box"},[a("div",{staticClass:"page-title bottom-shadow page-title-tab"},[a("Menu",{staticClass:"pl24",attrs:{mode:"horizontal",theme:"light","active-name":t.active_name}},t._l(t.menu,function(e,i){return a("MenuItem",{key:i,attrs:{name:i}},[t._v(t._s(e))])}))],1),t._v(" "),a("Row",{staticClass:"padding16-18",staticStyle:{background:"white","font-size":"18px","font-weight":"600",color:"#000",display:"flex"}},[a("i-col",{staticStyle:{display:"flex"}},[a("i-col",{staticClass:"borbox",staticStyle:{"padding-right":"25px"}},[a("span",[t._v("品牌渠道")]),t._v(" "),a("i-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择渠道"},on:{"on-change":t.ditchChange},model:{value:t.queryChannelOptions.brand,callback:function(e){t.$set(t.queryChannelOptions,"brand",e)},expression:"queryChannelOptions.brand"}},t._l(t.ditchList,function(e){return a("i-option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),a("i-col",{staticClass:"borbox",staticStyle:{"padding-right":"25px"}},[a("span",[t._v("区域")]),t._v(" "),a("i-select",{staticStyle:{width:"150px"},attrs:{placeholder:"请选择区域"},on:{"on-change":t.areaChange},model:{value:t.queryChannelOptions.area,callback:function(e){t.$set(t.queryChannelOptions,"area",e)},expression:"queryChannelOptions.area"}},t._l(t.areaList,function(e){return a("i-option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),a("i-col",{staticStyle:{"padding-right":"25px"}},[a("span",[t._v("门店")]),t._v(" "),a("i-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"请选择门店"},on:{"on-change":t.shopChange},model:{value:t.queryChannelOptions.shop,callback:function(e){t.$set(t.queryChannelOptions,"shop",e)},expression:"queryChannelOptions.shop"}},t._l(t.shopList,function(e){return a("i-option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),a("i-col",[a("Button",{attrs:{type:"primary"},on:{click:t.inquire}},[t._v("查询")])],1)],1),t._v(" "),a("i-col",{staticStyle:{"text-align":"right",flex:"1"}},[a("i",{staticClass:"el-icon-download",staticStyle:{"font-weight":"900","font-size":"17px","margin-right":"5px",cursor:"pointer"}}),t._v(" "),a("i",{staticClass:"el-icon-question",staticStyle:{"font-weight":"700","font-size":"17px",cursor:"pointer"}})])],1),t._v(" "),t.show?a("chart-page",{attrs:{title:"回访看板",loading:t.loading,allData:t.allData,vip:this.dimension[this.active_name]}}):t._e()],1)],1)},staticRenderFns:[]},s=a("VU/8")(o,l,!1,null,null,null);e.default=s.exports}});