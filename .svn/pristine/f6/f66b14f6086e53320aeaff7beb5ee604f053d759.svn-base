webpackJsonp([29],{hEyi:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={data:function(){var t=this;return{currentPage:1,pageSize:10,total:0,loadingOrNoData:"数据加载中...",isLoading:!1,selectData:[],specialMember:"",searLoading:!1,gridList:{columns:[{title:"姓名",key:"name"},{title:"邮箱",key:"email"},{title:"操作",key:"action",width:200,render:function(e,a){return e("a",{on:{click:function(){t.confirmDelete(a.row)}}},"取消授权")}}],data:[]},query:""}},created:function(){this.debounceSearch=this.$lodash.debounce(this.remoteSearchMethod,this.$config.throttle_wait)},mounted:function(){this.getData()},methods:{addSpecia:function(t){var e=this;if(t){var a="/sys/viewers/"+JSON.parse(t).id;this.$axios.post(""+this.$config.apiDomain+a,{}).then(function(){e.$Message.success("已添加"),e.currentPage=1,e.getData(),e.resetAddInput()}).catch(function(){e.resetAddInput()})}},resetAddInput:function(){this.specialMember="",this.selectData=[]},confirmDelete:function(t){var e=this;this.$Modal.confirm({title:"确认取消授权此帐号？",content:"姓名："+t.name+"<br/><br/>取消授权后，此账号将无法登陆当前渠道。",onOk:function(){e.deleteAccount(t.user_id)}})},deleteAccount:function(t){var e=this,a="/sys/viewers/"+t;this.$axios.delete(""+this.$config.apiDomain+a,{}).then(function(){e.$Message.destroy(),e.$Message.success("已取消授权"),e.currentPage>1&&1==e.gridList.data.length&&e.currentPage--,e.getData()})},getData:function(){var t=this;this.loadingOrNoData="数据加载中...",this.isLoading=!0;var e={page:this.currentPage,rows:this.pageSize};this.$axios.get(this.$config.apiDomain+"/sys/viewers",{params:e}).then(function(e){var a=e.data;a.items.length||(t.loadingOrNoData="暂无数据"),t.gridList.data=a.items,t.total=a.total,t.isLoading=!1}).catch(function(){t.total=0,t.gridList.data=[],t.loadingOrNoData="数据加载失败",t.isLoading=!1})},remoteMethod:function(t){this.query=t},remoteSearchMethod:function(){var t=this;if(""!==this.query){this.searLoading=!0;var e={q:this.query};this.$axios.get(this.$config.apiDomain+"/sys/viewers/users",{params:e,size:-1}).then(function(e){var a=e.data;t.searLoading=!1;var i=a.items.map(function(t){return{name:t.name,email:t.email,value:t.user_id}});t.selectData=i}).catch(function(){t.searLoading=!1})}else this.selectData=[]},pageChange:function(t){this.currentPage=t,this.getData()}},watch:{query:function(){this.debounceSearch()}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"channel-manage page-warpper"},[a("div",{staticClass:"page-title bottom-shadow page-title-tab"},[a("Menu",{staticClass:"pl24",attrs:{mode:"horizontal",theme:"light","active-name":"insight"}},[a("MenuItem",{attrs:{name:"insight"}},[t._v("租户洞察员")])],1)],1),t._v(" "),a("div",{staticClass:"page-content page-content-tab container-padding24"},[a("Card",{attrs:{"dis-hover":"",padding:0}},[a("Row",{staticClass:"padding16-18"},[a("Col",[a("Select",{staticClass:"width300",attrs:{placeholder:"请输入姓名/邮箱",filterable:"",remote:"","remote-method":t.remoteMethod,loading:t.searLoading},on:{"on-change":t.addSpecia},model:{value:t.specialMember,callback:function(e){t.specialMember=e},expression:"specialMember"}},t._l(t.selectData,function(e){return a("Option",{key:e.value,attrs:{value:'{"label":"'+e.email+'","id":"'+e.value+'"}',label:e.name}},[a("span",[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"name-email"},[t._v(t._s(e.email))])])})),t._v(" "),a("span",{staticClass:"total-count"},[t._v("共"),a("i",[t._v(t._s(t.total))]),t._v("个租户洞察员")])],1)],1),t._v(" "),a("Row",[a("Table",{staticClass:"smce-table-noscroll td-table-no-border",attrs:{loading:t.isLoading,"no-data-text":t.loadingOrNoData,columns:t.gridList.columns,data:t.gridList.data}}),t._v(" "),a("Row",{staticClass:"pageRow padding16-18",attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{total:t.total,current:t.currentPage,"show-elevator":""},on:{"on-change":t.pageChange}})],1)],1)],1)],1)])},staticRenderFns:[]};var s=a("VU/8")(i,n,!1,function(t){a("lbgL")},"data-v-ec0cac4c",null);e.default=s.exports},lbgL:function(t,e){}});